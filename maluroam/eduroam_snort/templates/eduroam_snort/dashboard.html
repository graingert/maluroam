{% extends "eduroam_snort/base.html" %}
{% load url from future %}
{% load crispy_forms_tags %}
{% block title%}Dashboard{% endblock title %}
{% block isdashboard%}active{% endblock %}
{% block content %}
    
    <div id="slider-range"></div>
    <form class="unstyled" id="activity-range">
        {{ activityRangeForm|crispy }}
    </form>
    
    <h2>Suspected Malicious Activity</h2>
    <p class="updateRangeSpan">
        <small></small>
    </p>
    
    <div class="span9" style="height:450px" id="chart1"></div>
    
    <div class="row">
        <div class="span6">
            <h2>Alert Totals Comparisons</h2>
            <p class="updateRangeSpan">
                <small></small>
            </p>
            <div id="donut" style="height:300px"></div>
        </div>
        <div class="span3" id="users_overview">
            <h2>Users</h2>
            <p class="updateRangeSpan">
                <small></small>
            </p>
        {% for user in users %}
            {% if forloop.first %}
                <table class="table table-bordered table-striped" id="users_overview">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Alerts</th>
                            <th>Packets</th>
                        </tr>
                    </thead>
                    <tbody>
            {% endif %}
                    <tr>
                        <td>
                            <a href="{% url 'user' user.username %}">{{user.username}}</a>
                        </td>
                        <td>{{user.id__count}}</td>
                        <td>{{user.alerts__sum}}</td>
                    </tr>
            {% if forloop.last %}
                    </tbody>
                </table>
            {% endif %}
        {% empty %}
            <div class="alert">No users for this range</div>
        {% endfor %}
        </div>
    </div>
{% endblock content %}

{% block scripts %}
    <script type="text/javascript" src="{{ STATIC_URL }}eduroam_snort/js/dashboard.js"></script>
{% endblock scripts %}
